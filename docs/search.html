<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>search / 搜索引擎</title>
    <script src="./raw.js"></script>
</head>
<script>
    function search() {
        search_by(document.getElementById('col-select').value, document.getElementById("q").value);
    }

    function search_by(key, value) {
        console.log(key, value);
        const filtered = RAW_DATA.filter(u => u[key].toLowerCase().includes(value.toLowerCase()));
        render_table(filtered);
    }

    function render_table(dat) {
        document.getElementById("res").innerHTML = "<table>" +
            dat.map(u => `
            <tr>
                <td><span lang="en">${u.english}</span></td>
                <td><a href="phrase/${u.pekzep_latin.replace(/[.!?"()]/g, "").split(" ").join("_")}.html">${u.pekzep_latin}</a></td>
                <td><span lang="ja">${u.pekzep_hanzi}</span></td>
                <td>${u.chinese_pinyin}</td>
                <td><span lang="zh-CN">${u.chinese_hanzi}</span></td>
            </tr>`).join("\n") + "</" + "table>"

    }
</script>

<body onload="search_by('english', '')">
    <h1><span lang="en">Spoonfed Pekzep</span> / <span lang="zh-CN">填鸭式牌语</span></h1>
    <a href="index.html"><span lang="en">Back to the main page</span> / <span lang="zh-CN">回到主页面</span></a>
    <h2><span lang="en">Search</span> / <span lang="zh-CN">搜索引擎</span></h2>
    <select name="cols" id="col-select" onchange="search()">
        <option value="english"><span lang="en">Search from English:</span> / <span lang="zh-CN">从英文搜索：</span></option>
        <option value="pekzep_latin"><span lang="en">Search from Pekzep (alphabet):</span> / <span lang="zh-CN">从英字牌文搜索：</span></option>
        <option value="pekzep_hanzi"><span lang="en">Search from Pekzep (Chinese characters):</span> / <span lang="zh-CN">从汉字牌文搜索：</span></option>
        <option value="chinese_hanzi"><span lang="en">Search from Chinese:</span> / <span lang="zh-CN">从中文搜索：</span> </option>
    </select> <input type="text" id="q" onkeyup="search();" autofocus><br>
    <hr>
    <div id="res">

    </div>
</body>